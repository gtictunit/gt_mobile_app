{"version":3,"names":["React","Button","Text","View","StyleSheet","Animated","Surface","shadow","withTheme","ELEVATION","DEFAULT_MAX_WIDTH","Banner","initiallyVisible","dismissable","icon","buttonColor","content","contentStyle","style","theme","Icon","rest","visible","setVisible","useState","useEffect","current","position","useRef","Value","layout","setLayout","height","measured","timing","duration","toValue","useNativeDriver","start","handleLayout","nativeEvent","multiply","translateY","add","styles","container","wrapper","absolute","transform","opacity","marginBottom","message","color","colors","text","actions","primary","create","elevation","overflow","alignSelf","width","maxWidth","top","flexDirection","justifyContent","marginHorizontal","marginTop","margin","flex"],"sources":["Banner.tsx"],"sourcesContent":["import * as React from \"react\";\nimport {\n  Button,\n  Text,\n  View,\n  ViewStyle,\n  StyleSheet,\n  StyleProp,\n  Animated,\n} from \"react-native\";\nimport Surface from \"./Surface\";\nimport type { IconSlot } from \"../interfaces/Icon\";\nimport shadow from \"../styles/shadow\";\nimport { withTheme } from \"../theming\";\nimport type { Theme } from \"../styles/DefaultTheme\";\n\nconst ELEVATION = 1;\nconst DEFAULT_MAX_WIDTH = 960;\n\ntype Props = {\n  initiallyVisible: boolean;\n  dismissable: boolean;\n  buttonColor?: string;\n  icon?: string;\n  content?: string;\n  contentStyle?: StyleProp<ViewStyle>;\n  style?: StyleProp<ViewStyle>;\n  ref?: React.RefObject<View>;\n  /**\n   * @optional\n   */\n  theme: Theme;\n} & IconSlot;\n\ntype NativeEvent = {\n  nativeEvent: {\n    layout: {\n      x: number;\n      y: number;\n      width: number;\n      height: number;\n    };\n  };\n};\n\nconst Banner: React.FC<React.PropsWithChildren<Props>> = ({\n  initiallyVisible = true,\n  dismissable = true,\n  icon,\n  buttonColor,\n  content,\n  contentStyle,\n  style,\n  theme,\n  Icon,\n  ...rest\n}) => {\n  const [visible, setVisible] = React.useState(initiallyVisible);\n\n  React.useEffect(() => {\n    if (initiallyVisible) {\n      setVisible(true);\n    }\n  }, [initiallyVisible]);\n\n  const { current: position } = React.useRef<Animated.Value>(\n    new Animated.Value(visible ? 1 : 0)\n  );\n  const [layout, setLayout] = React.useState<{\n    height: number;\n    measured: boolean;\n  }>({\n    height: 0,\n    measured: false,\n  });\n\n  React.useEffect(() => {\n    if (visible) {\n      // show\n      Animated.timing(position, {\n        duration: 250,\n        toValue: 1,\n        useNativeDriver: false,\n      }).start();\n    } else {\n      // hide\n      Animated.timing(position, {\n        duration: 200,\n        toValue: 0,\n        useNativeDriver: false,\n      }).start();\n    }\n  }, [visible, position]);\n\n  const handleLayout = ({ nativeEvent }: NativeEvent) => {\n    const { height } = nativeEvent.layout;\n    setLayout({ height, measured: true });\n  };\n\n  // The banner animation has 2 parts:\n  // 1. Blank spacer element which animates its height to move the content\n  // 2. Actual banner which animates its translateY\n  // In initial render, we position everything normally and measure the height of the banner\n  // Once we have the height, we apply the height to the spacer and switch the banner to position: absolute\n  // We need this because we need to move the content below as if banner's height was being animated\n  // However we can't animated banner's height directly as it'll also resize the content inside\n  const height = Animated.multiply(position, layout.height);\n\n  const translateY = Animated.multiply(\n    Animated.add(position, -1),\n    layout.height\n  );\n\n  return (\n    <Surface\n      {...rest}\n      style={[styles.container, shadow(ELEVATION) as ViewStyle, style]}\n    >\n      <View style={[styles.wrapper, contentStyle]}>\n        <Animated.View style={{ height }} />\n        <Animated.View\n          onLayout={handleLayout}\n          style={[\n            layout.measured || !visible\n              ? // If we have measured banner's height or it's invisible,\n                // Position it absolutely, the layout will be taken care of the spacer\n                [styles.absolute, { transform: [{ translateY }] }]\n              : // Otherwise position it normally\n                null,\n            !layout.measured && !visible\n              ? // If we haven't measured banner's height yet and it's invisible,\n                // hide it with opacity: 0 so user doesn't see it\n                { opacity: 0 }\n              : null,\n          ]}\n        >\n          <View\n            style={[styles.content, { marginBottom: dismissable ? 0 : 16 }]}\n          >\n            {icon ? (\n              <View style={styles.icon}>\n                <Icon name={icon} size={40} />\n              </View>\n            ) : null}\n            <Text\n              style={[styles.message, { color: theme.colors.text }]}\n              accessibilityLiveRegion={visible ? \"polite\" : \"none\"}\n              accessibilityRole=\"alert\"\n            >\n              {content}\n            </Text>\n          </View>\n          {dismissable ? (\n            <View style={styles.actions}>\n              <Button\n                color={buttonColor || theme.colors.primary}\n                title=\"Close\"\n                onPress={() => setVisible(false)}\n              />\n            </View>\n          ) : null}\n        </Animated.View>\n      </View>\n    </Surface>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    elevation: ELEVATION,\n  },\n  wrapper: {\n    overflow: \"hidden\",\n    alignSelf: \"center\",\n    width: \"100%\",\n    maxWidth: DEFAULT_MAX_WIDTH,\n  },\n  absolute: {\n    position: \"absolute\",\n    top: 0,\n    width: \"100%\",\n  },\n  content: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-start\",\n    marginHorizontal: 8,\n    marginTop: 16,\n    marginBottom: 0,\n  },\n  icon: {\n    margin: 8,\n  },\n  message: {\n    flex: 1,\n    margin: 8,\n  },\n  actions: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    margin: 8,\n  },\n});\n\nexport default withTheme(Banner);\n"],"mappings":"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"}