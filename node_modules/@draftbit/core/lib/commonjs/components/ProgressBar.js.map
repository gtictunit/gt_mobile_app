{"version":3,"names":["INDETERMINATE_WIDTH_FACTOR","BAR_WIDTH_ZERO_POSITION","ProgressBar","Component","constructor","props","event","width","onLayout","setState","nativeEvent","layout","progress","progressP","indeterminate","Math","min","max","state","Animated","Value","animationValue","componentDidMount","animate","componentDidUpdate","prevProps","useNativeDriver","animationType","animationConfig","bounciness","animated","spring","toValue","start","velocity","setValue","indeterminateAnimationDuration","timing","duration","easing","Easing","linear","isInteraction","endState","finished","render","borderColor","borderRadius","borderWidth","children","color","style","unfilledColor","restProps","innerWidth","containerStyle","overflow","backgroundColor","progressStyle","height","transform","translateX","interpolate","inputRange","outputRange","I18nManager","isRTL","scaleX","handleLayout"],"sources":["ProgressBar.tsx"],"sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Animated,\n  Easing,\n  View,\n  I18nManager,\n  ViewProps,\n  StyleProp,\n  ViewStyle,\n  LayoutChangeEvent,\n} from \"react-native\";\n\nconst INDETERMINATE_WIDTH_FACTOR = 0.3;\nconst BAR_WIDTH_ZERO_POSITION =\n  INDETERMINATE_WIDTH_FACTOR / (1 + INDETERMINATE_WIDTH_FACTOR);\n\ntype Props = {\n  borderColor?: string;\n  borderRadius?: number;\n  borderWidth?: number;\n  children?: React.ReactNode;\n  color?: string;\n  height?: number;\n  style?: StyleProp<ViewStyle>;\n  unfilledColor?: string;\n  width?: number;\n  animated?: boolean;\n  indeterminate?: boolean;\n  indeterminateAnimationDuration?: number;\n  progress?: number;\n  useNativeDriver?: boolean;\n  animationConfig?: Animated.AnimationConfig;\n  animationType?: \"decay\" | \"timing\" | \"spring\";\n} & ViewProps;\n\ninterface State {\n  width: number;\n  progress: Animated.Value;\n  animationValue: Animated.Value;\n}\n\nexport default class ProgressBar extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    const { progress: progressP = 0, indeterminate = false } = props;\n    const progress = Math.min(Math.max(progressP, 0), 1);\n    this.state = {\n      width: 0,\n      progress: new Animated.Value(\n        indeterminate ? INDETERMINATE_WIDTH_FACTOR : progress\n      ),\n      animationValue: new Animated.Value(BAR_WIDTH_ZERO_POSITION),\n    };\n  }\n\n  componentDidMount() {\n    const { indeterminate = false } = this.props;\n    if (indeterminate) {\n      this.animate();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const {\n      indeterminate = false,\n      useNativeDriver = false,\n      progress: progressP = 0,\n      animationType = \"spring\",\n      animationConfig = { bounciness: 0 },\n      animated = true,\n    } = this.props;\n\n    if (prevProps.indeterminate !== indeterminate) {\n      if (indeterminate) {\n        this.animate();\n      } else {\n        Animated.spring(this.state.animationValue, {\n          toValue: BAR_WIDTH_ZERO_POSITION,\n          useNativeDriver,\n        }).start();\n      }\n    }\n    if (\n      prevProps.indeterminate !== indeterminate ||\n      prevProps.progress !== progressP\n    ) {\n      const progress = this.props.indeterminate\n        ? INDETERMINATE_WIDTH_FACTOR\n        : Math.min(Math.max(progressP, 0), 1);\n\n      if (animated) {\n        Animated[animationType](this.state.progress, {\n          ...animationConfig,\n          toValue: progress,\n          velocity: 0, //adjust this value if animation fails - velocity is required\n          useNativeDriver,\n        }).start();\n      } else {\n        this.state.progress.setValue(progress);\n      }\n    }\n  }\n\n  handleLayout = (event: LayoutChangeEvent) => {\n    const { width = 150, onLayout } = this.props;\n    if (!width) {\n      this.setState({ width: event.nativeEvent.layout.width });\n    }\n    if (onLayout) {\n      onLayout(event);\n    }\n  };\n\n  animate() {\n    const { useNativeDriver = false, indeterminateAnimationDuration = 1000 } =\n      this.props;\n    this.state.animationValue.setValue(0);\n    Animated.timing(this.state.animationValue, {\n      toValue: 1,\n      duration: indeterminateAnimationDuration,\n      easing: Easing.linear,\n      isInteraction: false,\n      useNativeDriver,\n    }).start((endState) => {\n      if (endState.finished) {\n        this.animate();\n      }\n    });\n  }\n\n  render() {\n    const {\n      borderColor,\n      borderRadius = 4,\n      borderWidth = 1,\n      children,\n      color = \"rgba(0, 122, 255, 1)\",\n      style,\n      unfilledColor,\n      width = 150,\n      ...restProps\n    } = this.props;\n\n    const innerWidth = Math.max(0, width || this.state.width) - borderWidth * 2;\n    const containerStyle: StyleProp<ViewStyle> = {\n      width,\n      borderWidth,\n      borderColor: borderColor || color,\n      borderRadius,\n      overflow: \"hidden\",\n      backgroundColor: unfilledColor,\n    };\n    const progressStyle = {\n      backgroundColor: color,\n      // Always take up full height of container.\n      height: \"100%\",\n      transform: [\n        {\n          translateX: this.state.animationValue.interpolate({\n            inputRange: [0, 1],\n            outputRange: [innerWidth * -INDETERMINATE_WIDTH_FACTOR, innerWidth],\n          }),\n        },\n        {\n          translateX: this.state.progress.interpolate({\n            inputRange: [0, 1],\n            outputRange: [innerWidth / (I18nManager.isRTL ? 2 : -2), 0],\n          }),\n        },\n        {\n          // Interpolation a temp workaround for https://github.com/facebook/react-native/issues/6278\n          scaleX: this.state.progress.interpolate({\n            inputRange: [0, 1],\n            outputRange: [0.0001, 1],\n          }),\n        },\n      ],\n    };\n\n    return (\n      <View\n        style={[containerStyle, style]}\n        onLayout={this.handleLayout}\n        {...restProps}\n      >\n        <Animated.View style={progressStyle} />\n        {children}\n      </View>\n    );\n  }\n}\n"],"mappings":"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"}